# xxk_rmm
xxk rmm Agent is a self-contained Windows agent that enables remote administration, monitoring, and control of endpoints through a WebSocket-based management console. It runs as a Windows service in the background and supports both direct (active) and server-relayed (passive) connection modes.

# Overview
Infinity RMM Agent is a self-contained Windows agent that enables remote administration, monitoring, and control of endpoints through a WebSocket-based management console. It runs as a Windows service in the background and supports both direct (active) and server-relayed (passive) connection modes.
Features

Remote Desktop — Real-time screen capture streamed to the browser; supports adjustable JPEG quality and resolution scaling
Remote Input Control — Full mouse (move, click, scroll) and keyboard control forwarded to the remote session
Interactive Shell — Stateful command execution (maintains working directory across commands) with UTF-8 / GBK output decoding
File Manager — Browse drives and directories, upload/download files, delete files and folders, execute files with optional UAC elevation
File Pull — Download files from a URL directly to the remote machine with real-time progress reporting and cancellation support
System Information — CPU, memory, disk usage and host metadata reported on demand
Process Manager — List all running processes and kill them by PID
USB Device Monitor — Real-time detection and logging of USB device insertion/removal events
Password-Protected Access — WebSocket connections authenticated via a password header; web UI login page included
Encrypted Configuration — Config file encrypted with AES-256-GCM; password and settings stored securely on disk
Windows Service Support — Installs, starts, and stops as a native Windows service via kardianos/service
Passive Mode (Reverse Connection) — Agent connects outbound to a management server, enabling access through NAT/firewalls without port forwarding
Session-Aware Screen Capture — Spawns a child process in the active user session via WTSQueryUserToken / CreateProcessAsUser to capture the desktop correctly when running as SYSTEM
Auto-restart Watchdog — Automatically respawns the child capture process if it dies

![项目截图](./screenshot.png)
